unit unVENDA;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.ComCtrls, Vcl.Grids,
  Vcl.DBGrids;

type
  TfrmVENDA = class(TForm)
    DateTimePicker1: TDateTimePicker;
    ComboBox1: TComboBox;
    ComboBox2: TComboBox;
    Label1: TLabel;
    Label2: TLabel;
    Label3: TLabel;
    edTotal: TEdit;
    lbl: TLabel;
    Button2: TButton;
    Button3: TButton;
    Label4: TLabel;
    edCOD_PED: TEdit;
    Button1: TButton;
    Button4: TButton;
    Button5: TButton;
    procedure Edit1Exit(Sender: TObject);
    procedure Button2Click(Sender: TObject);
  private
    { Private declarations }
  public
  nro :String;
    { Public declarations }
  end;

var
  frmVENDA: TfrmVENDA;

implementation

{$R *.dfm}

uses uDM;

procedure TfrmVENDA.Button2Click(Sender: TObject);
begin
   DM.cdsCONSULTA.Close;
   DM.cdsCONSULTA.CommandText := 'select gen_id(gen_ped, 1) as NRO from rdb$database';
   DM.cdsCONSULTA.Open;
   nro := DM.cdsCONSULTA.FieldByName('NRO').AsString;
   edCOD_PED.Text := nro;

end;

procedure TfrmVENDA.Edit1Exit(Sender: TObject);
begin
if Edit1.Text <> '' then
begin
  DM.cdsPEDIDO.Close;
  DM.cdsPEDIDO.CommandText := 'select * from pedido where cod_ped = ' + Edit1.Text;
  DM.cdsPEDIDO.Open;
  if DM.cdsPEDIDO.IsEmpty then
     DM.cdsPEDIDO.Insert
  else
     DM.cdsPEDIDO.Edit;

end;
end;

end.
